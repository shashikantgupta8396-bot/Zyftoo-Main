{
    "sourceFile": "Ninico/components/admin/sections/CategorySelector.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1753289008654,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1753289008654,
            "name": "Commit-0",
            "content": "import React from 'react'\r\nimport MainCategoriesList from './MainCategoriesList'\r\nimport SubcategoriesList from './SubcategoriesList'\r\n\r\nexport default function CategorySelector({\r\n  availableCategories,\r\n  subcategories,\r\n  categoryConfig,\r\n  selectedMainCategory,\r\n  setSelectedMainCategory,\r\n  handleCategoryToggle,\r\n  getCurrentCounts,\r\n  MAX_SUBCATEGORIES_PER_CATEGORY\r\n}) {\r\n  const mainCategories = availableCategories.filter(cat => !cat.parent)\r\n\r\n  // Get subcategories for selected main category\r\n  const getSubcategoriesForCategory = (categoryId) => {\r\n    console.log('🔍 Getting subcategories for category ID:', categoryId)\r\n    const filtered = subcategories.filter(subCat => {\r\n      const parentId = subCat.parent?._id || subCat.parent\r\n      const match = parentId === categoryId\r\n      console.log(`   - Subcategory \"${subCat.name}\" parent: ${parentId}, matches: ${match}`)\r\n      return match\r\n    })\r\n    console.log(`   - Found ${filtered.length} subcategories for category ${categoryId}:`, filtered)\r\n    return filtered\r\n  }\r\n\r\n  // Auto-select first main category if none selected\r\n  if (!selectedMainCategory && mainCategories.length > 0) {\r\n    setSelectedMainCategory(mainCategories[0].id)\r\n  }\r\n\r\n  const selectedCategorySubcategories = selectedMainCategory ? \r\n    getSubcategoriesForCategory(selectedMainCategory) : []\r\n\r\n  // Bulk actions\r\n  const handleSelectAllMainCategories = () => {\r\n    mainCategories.forEach(category => {\r\n      if (!categoryConfig.categoryIds.includes(category.id)) {\r\n        handleCategoryToggle(category.id)\r\n      }\r\n    })\r\n  }\r\n\r\n  const handleSelectAllSubcategories = () => {\r\n    subcategories.forEach(subcategory => {\r\n      if (!categoryConfig.categoryIds.includes(subcategory.id)) {\r\n        const parentId = subcategory.parent?._id || subcategory.parent\r\n        handleCategoryToggle(subcategory.id, parentId)\r\n      }\r\n    })\r\n  }\r\n\r\n  const handleClearAllSelections = () => {\r\n    // Clear all selections by setting empty array\r\n    categoryConfig.categoryIds.forEach(categoryId => {\r\n      if (mainCategories.some(cat => cat.id === categoryId)) {\r\n        handleCategoryToggle(categoryId)\r\n      } else if (subcategories.some(sub => sub.id === categoryId)) {\r\n        const subcategory = subcategories.find(sub => sub.id === categoryId)\r\n        const parentId = subcategory?.parent?._id || subcategory?.parent\r\n        handleCategoryToggle(categoryId, parentId)\r\n      }\r\n    })\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div className=\"row mb-4\">\r\n        <div className=\"col-12\">\r\n          <label className=\"form-label fw-semibold mb-3\">Select Categories and Subcategories</label>\r\n          \r\n          {mainCategories.length > 0 ? (\r\n            <div className=\"row\">\r\n              {/* Main Categories */}\r\n              <MainCategoriesList\r\n                mainCategories={mainCategories}\r\n                categoryConfig={categoryConfig}\r\n                selectedMainCategory={selectedMainCategory}\r\n                setSelectedMainCategory={setSelectedMainCategory}\r\n                handleCategoryToggle={handleCategoryToggle}\r\n                getCurrentCounts={getCurrentCounts}\r\n              />\r\n\r\n              {/* Subcategories */}\r\n              <SubcategoriesList\r\n                selectedMainCategory={selectedMainCategory}\r\n                selectedCategorySubcategories={selectedCategorySubcategories}\r\n                mainCategories={mainCategories}\r\n                categoryConfig={categoryConfig}\r\n                handleCategoryToggle={handleCategoryToggle}\r\n                MAX_SUBCATEGORIES_PER_CATEGORY={MAX_SUBCATEGORIES_PER_CATEGORY}\r\n              />\r\n            </div>\r\n          ) : (\r\n            <div className=\"text-center py-5\">\r\n              <i className=\"bi bi-folder2-open text-muted\" style={{ fontSize: '3rem' }}></i>\r\n              <p className=\"mt-2 text-muted\">No categories available</p>\r\n              <small className=\"text-muted\">Create categories first to configure this section.</small>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Bulk Actions */}\r\n      {mainCategories.length > 0 && (\r\n        <div className=\"row\">\r\n          <div className=\"col-12\">\r\n            <div className=\"d-flex gap-2 flex-wrap\">\r\n              <button \r\n                type=\"button\" \r\n                className=\"btn btn-outline-primary btn-sm\"\r\n                onClick={handleSelectAllMainCategories}\r\n              >\r\n                <i className=\"bi bi-check-all me-1\"></i>\r\n                Select All Main Categories\r\n              </button>\r\n              \r\n              <button \r\n                type=\"button\" \r\n                className=\"btn btn-outline-success btn-sm\"\r\n                onClick={handleSelectAllSubcategories}\r\n              >\r\n                <i className=\"bi bi-tags me-1\"></i>\r\n                Select All Subcategories\r\n              </button>\r\n              \r\n              <button \r\n                type=\"button\" \r\n                className=\"btn btn-outline-secondary btn-sm\"\r\n                onClick={handleClearAllSelections}\r\n              >\r\n                <i className=\"bi bi-x-circle me-1\"></i>\r\n                Clear All Selections\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </>\r\n  )\r\n}\r\n"
        }
    ]
}
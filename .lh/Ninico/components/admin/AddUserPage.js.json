{
    "sourceFile": "Ninico/components/admin/AddUserPage.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1753281699560,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1753281699560,
            "name": "Commit-0",
            "content": "'use client'\r\nimport { useState } from 'react'\r\n\r\nconst initialState = {\r\n  name: '',\r\n  email: '',\r\n  phone: '',\r\n  password: '',\r\n  userType: 'Customer',\r\n  status: 'Active',\r\n  role: 'user',\r\n  gender: '',\r\n  dob: '',\r\n  pincode: '',\r\n  isVerified: false,\r\n  emailVerified: false,\r\n  emailVerificationToken: '',\r\n  companyDetails: {\r\n    companyName: '',\r\n    gstNumber: '',\r\n    address: ''\r\n  },\r\n  lastLogin: ''\r\n}\r\n\r\nexport default function AddUserPage({ onSuccess, onCancel }) {\r\n  const [form, setForm] = useState(initialState)\r\n  const [loading, setLoading] = useState(false)\r\n  const [error, setError] = useState('')\r\n  const [success, setSuccess] = useState('')\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value, type, checked } = e.target\r\n    if (name.startsWith('companyDetails.')) {\r\n      const key = name.split('.')[1]\r\n      setForm(prev => ({ ...prev, companyDetails: { ...prev.companyDetails, [key]: value } }))\r\n    } else if (type === 'checkbox') {\r\n      setForm(prev => ({ ...prev, [name]: checked }))\r\n    } else {\r\n      setForm(prev => ({ ...prev, [name]: value }))\r\n    }\r\n  }\r\n\r\n  // API base URL\r\n  const API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:5000/api'\r\n  \r\n  // Hardcoded admin token for testing\r\n  const ADMIN_TOKEN = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NzZhYTJmYzc3YWY4ODU3Njk1ZDA5MiIsInJvbGUiOiJhZG1pbiIsImlhdCI6MTc1MzI4MTMyMCwiZXhwIjoxNzUzODg2MTIwfQ.3wEx7ZCDvYtUQppFM9CcXjhG1zTQX9_RYY_dy3Y6MZs'\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault()\r\n    setLoading(true)\r\n    setError('')\r\n    setSuccess('')\r\n    try {\r\n      // Save user via users API with auth middleware\r\n      const res = await fetch(`${API_BASE_URL}/users`, {\r\n        method: 'POST',\r\n        headers: { \r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${ADMIN_TOKEN}`\r\n        },\r\n        body: JSON.stringify(form)\r\n      })\r\n      if (!res.ok) throw new Error((await res.json()).message || 'Failed to add user')\r\n      setSuccess('User added successfully!')\r\n      if (onSuccess) onSuccess()\r\n      setForm(initialState)\r\n    } catch (err) {\r\n      setError(err.message)\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"container-fluid\">\r\n      <h2 className=\"fw-bold mb-3\">Add New User</h2>\r\n      {error && <div className=\"alert alert-danger\">{error}</div>}\r\n      {success && <div className=\"alert alert-success\">{success}</div>}\r\n      <form onSubmit={handleSubmit} className=\"row g-3\">\r\n        <div className=\"col-md-6\">\r\n          <label className=\"form-label\">Name *</label>\r\n          <input type=\"text\" className=\"form-control\" name=\"name\" value={form.name} onChange={handleChange} required />\r\n        </div>\r\n        <div className=\"col-md-6\">\r\n          <label className=\"form-label\">Email *</label>\r\n          <input type=\"email\" className=\"form-control\" name=\"email\" value={form.email} onChange={handleChange} required />\r\n        </div>\r\n        <div className=\"col-md-6\">\r\n          <label className=\"form-label\">Phone</label>\r\n          <input type=\"text\" className=\"form-control\" name=\"phone\" value={form.phone} onChange={handleChange} />\r\n        </div>\r\n        <div className=\"col-md-6\">\r\n          <label className=\"form-label\">Password *</label>\r\n          <input type=\"password\" className=\"form-control\" name=\"password\" value={form.password} onChange={handleChange} required />\r\n        </div>\r\n        <div className=\"col-md-6\">\r\n          <label className=\"form-label\">User Type</label>\r\n          <select className=\"form-select\" name=\"userType\" value={form.userType} onChange={handleChange}>\r\n            <option value=\"SuperAdmin\">SuperAdmin</option>\r\n            <option value=\"Admin\">Admin</option>\r\n            <option value=\"Customer\">Customer</option>\r\n            <option value=\"Corporate\">Corporate</option>\r\n          </select>\r\n        </div>\r\n        <div className=\"col-md-6\">\r\n          <label className=\"form-label\">Status</label>\r\n          <select className=\"form-select\" name=\"status\" value={form.status} onChange={handleChange}>\r\n            <option value=\"Active\">Active</option>\r\n            <option value=\"Blocked\">Blocked</option>\r\n          </select>\r\n        </div>\r\n        <div className=\"col-md-6\">\r\n          <label className=\"form-label\">Role</label>\r\n          <select className=\"form-select\" name=\"role\" value={form.role} onChange={handleChange}>\r\n            <option value=\"user\">User</option>\r\n            <option value=\"admin\">Admin</option>\r\n            <option value=\"tempAdmin\">Temp Admin</option>\r\n          </select>\r\n        </div>\r\n        <div className=\"col-md-6\">\r\n          <label className=\"form-label\">Gender</label>\r\n          <select className=\"form-select\" name=\"gender\" value={form.gender} onChange={handleChange}>\r\n            <option value=\"\">Select</option>\r\n            <option value=\"male\">Male</option>\r\n            <option value=\"female\">Female</option>\r\n            <option value=\"others\">Others</option>\r\n          </select>\r\n        </div>\r\n        <div className=\"col-md-6\">\r\n          <label className=\"form-label\">Date of Birth</label>\r\n          <input type=\"date\" className=\"form-control\" name=\"dob\" value={form.dob} onChange={handleChange} />\r\n        </div>\r\n        <div className=\"col-md-6\">\r\n          <label className=\"form-label\">Pincode</label>\r\n          <input type=\"text\" className=\"form-control\" name=\"pincode\" value={form.pincode} onChange={handleChange} />\r\n        </div>\r\n        <div className=\"col-md-6\">\r\n          <label className=\"form-label\">Company Name</label>\r\n          <input type=\"text\" className=\"form-control\" name=\"companyDetails.companyName\" value={form.companyDetails.companyName} onChange={handleChange} />\r\n        </div>\r\n        <div className=\"col-md-6\">\r\n          <label className=\"form-label\">GST Number</label>\r\n          <input type=\"text\" className=\"form-control\" name=\"companyDetails.gstNumber\" value={form.companyDetails.gstNumber} onChange={handleChange} />\r\n        </div>\r\n        <div className=\"col-12\">\r\n          <label className=\"form-label\">Company Address</label>\r\n          <input type=\"text\" className=\"form-control\" name=\"companyDetails.address\" value={form.companyDetails.address} onChange={handleChange} />\r\n        </div>\r\n        <div className=\"col-12 d-flex gap-2 mt-3\">\r\n          <button type=\"submit\" className=\"btn btn-success\" disabled={loading}>{loading ? 'Saving...' : 'Add User'}</button>\r\n          {onCancel && <button type=\"button\" className=\"btn btn-secondary\" onClick={onCancel}>Cancel</button>}\r\n        </div>\r\n      </form>\r\n    </div>\r\n  )\r\n}\r\n"
        }
    ]
}